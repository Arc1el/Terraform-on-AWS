# Terraform 언어 문법

소유자: 익명
최종 편집 일시: 2023년 4월 12일 오후 12:51
태그: AWS, Terraform

## **Terraform 언어 문법**

### **Step-01: 소개**

- 기본적인 Terraform의 신택스에 대해서 이해합니다
    - Blocks
    - Arguments, Attributes & Meta-Arguments
    - Identifiers
    - Comments

### **Step-02: Terraform 설정 언어 문법**

```json
# 템플릿
# 블록바디 시작
<BLOCK TYPE> "<BLOCK LABEL>" "<BLOCK LABEL>"   {
  # 아규먼트
  <IDENTIFIER> = <EXPRESSION>
}

# AWS 예시
# 블록 시작
resource "aws_instance" "ec2demo" {
	# 아규먼트
  ami           = "ami-04d29b6f966df1537"
	# Variable Value 표현식을 가진 아규먼트
	# Variable Value는 variables.tf 파일에서 대체되어짐
  instance_type = var.instance_type
}
# 블록 끝
```

### **Step-03: Arguments, Attributes, Meta-Arguments 이해**

- Arguments는 `필수(required)` 이거나 `선택(optional)`
- Attribues 포맷은 `resource_type.resource_name.attribute_name` 와 같은 형태이어야 합니다.
- Meta-Arguments 는 리소스 타입의 behavior (Example: count, for_each) 에 따라 바뀝니다.
- 🔗 [Additional Reference](https://learn.hashicorp.com/tutorials/terraform/resource?in=terraform/configuration-language)
- 🔗 [Resource: AWS Instance](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance)
- 🔗 [Resource: AWS Instance Argument Reference](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#argument-reference)
- 🔗 [Resource: AWS Instance Attribute Reference](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#attributes-reference)
- 🔗 [Resource: Meta-Arguments](https://www.terraform.io/docs/language/meta-arguments/depends_on.html)

### **Step-04: Terraform Top-Level Blocks 이해**

Terraform에서는 다양한 Top-Level Block이 존재합니다. 이러한 블록들은 Terraform 파일의 최상위 수준에 위치하며, 테라폼 코드를 정의하고 Terraform의 동작을 설정하는 데 사용됩니다. 

- **Terraform Settings Block
`Terraform Settings Block`**은 테라폼 설정을 정의하는 데 사용됩니다. **`required_providers`**를 포함하여 AWS, GCP, Azure, DigitalOcean과 같은 공급자, 백엔드, 버전 제어 등과 같은 전역 Terraform 설정을 정의할 수 있습니다. 이 블록을 사용하여 다양한 옵션을 구성하고 프로젝트의 구성을 최적화할 수 있습니다.
- **Provider Block
`Provider Block`**은 특정 공급자(예: AWS, GCP 등)와 연결된 자원을 정의합니다. 이 블록은 공급자와 상호 작용하고 프로젝트의 자원을 생성하고 관리합니다. 이 블록에서는 사용할 공급자를 지정하고 AWS, Azure, GCP와 같은 공급자의 인증 정보(예: API 키, 비밀 키)를 정의할 수 있습니다.
- **Resource Block
`Resource Block`**은 인프라의 개별 리소스(예: EC2 인스턴스, VPC, 서브넷 등)를 정의합니다. 이 블록에서는 리소스 유형과 이름, 속성, 태그 등을 지정할 수 있습니다. 이 블록을 사용하여 인프라를 생성, 관리, 수정 및 삭제할 수 있습니다.
- **Input Variables Block
`Input Variables Block`**은 템플릿에서 사용할 변수를 정의합니다. 변수는 Terraform 파일에서 사용할 수 있으며 템플릿에서 값을 전달받을 수 있는 방법을 제공합니다. 변수는 템플릿에서 사용할 데이터를 구성하는 데 도움이 되며, 코드 재사용성을 높일 수 있습니다.
- **Output Values Block
`Output Values Block`**은 테라폼 실행 후 표시되는 값(예: IP 주소, 리소스 이름 등)을 정의합니다. 이 블록은 리소스의 출력을 정의할 수도 있습니다. 이 블록은 다른 Terraform 모듈에서 출력된 값을 사용하는 데 도움이 됩니다.
- **Local Values Block
`Local Values Block`**은 지역 변수를 정의하는 데 사용됩니다. 이 블록에서는 다른 블록에서 사용할 지역 변수를 정의하고 사용할 수 있습니다. 이 블록을 사용하여 다른 블록에서 사용할 값을 계산하고 저장할 수 있습니다.
- **Data Sources Block
`Data Sources Block`**은 인프라의 데이터를 정의합니다. 이블록에서는 인프라 상태의 데이터를 검색할 수 있는 방법을 제공합니다. 이 블록은 외부 시스템에서 데이터를 가져오는 데 사용됩니다. 이 블록에서는 외부 데이터 소스의 유형과 위치를 지정할 수 있습니다.
- **Modules Block
`Modules Block`**은 Terraform 코드를 모듈화하는 데 사용됩니다. 모듈은 인프라의 동일한 유형의 리소스를 여러 번 생성하는 데 사용됩니다. 이 블록에서는 다른 Terraform 파일에서 모듈로 재사용할 수 있는 리소스와 구성을 정의할 수 있습니다. 모듈화를 사용하면 코드 재사용성을 높이고 유지보수 및 확장성을 개선할 수 있습니다.

블록을 적절하게 사용하여 인프라를 생성, 관리 및 수정할 수 있으며, 코드 재사용성을 높이고 유지보수성을 개선할 수 있습니다.

### References

[Overview - Configuration Language | Terraform | HashiCorp Developer](https://developer.hashicorp.com/terraform/language)

[Syntax - Configuration Language | Terraform | HashiCorp Developer](https://developer.hashicorp.com/terraform/language/syntax/configuration)